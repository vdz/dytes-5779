import{j as e}from"./jsx-runtime.TBa3i5EZ.js";import{r as i}from"./index.CVf8TyFT.js";import{R as u}from"./RichText.DkutzfuB.js";import{D as t}from"./ui-display-modes.B23pBYFS.js";import"./rich-text-react-renderer.es5.D1Vgn1LL.js";function f(s){return`${s.getDate()}/${s.getMonth()+1}/${s.getFullYear()} ${s.getHours()}:${String(s.getMinutes()).padStart(2,"0")} (זמן ישראל)`}function p({title:s,body:a,author:o,publish_date:n}){const c=new Date(n);return e.jsxs("div",{className:"Flash",children:[e.jsx("h3",{className:"subject",children:s}),e.jsx("div",{className:"body",children:e.jsx(u,{content:a})}),e.jsx("span",{className:"author",children:o})," ",e.jsxs("span",{className:"date",children:["— ",f(c)]})]})}const x=["normal","processing","error","done","active"];function D({index:s,spaceId:a,accessToken:o}){const[n,c]=i.useState([]),[d,l]=i.useState(t.normal);i.useEffect(()=>{l(t.processing),fetch(`https://cdn.contentful.com/spaces/${a}/environments/master/entries?access_token=${o}&content_type=flash&fields.page_index=${s}&order=-fields.order,-fields.publish_date`).then(r=>r.json()).then(r=>{c(r.items||[]),l(t.done)}).catch(()=>{l(t.error)})},[s,a,o]);const h=()=>{switch(d){case t.processing:return e.jsx("div",{className:"Loader processing",children:"מחפש מבזקים ..."});case t.error:return e.jsx("div",{className:"Loader error",children:"לא הצלחנו להביא עדכונים."});case t.done:return n.length?null:"אין מבזקים לפי שעה";default:return null}},m=()=>n.length?n.map(r=>e.jsx(p,{...r.fields},`flash-${r.sys.id}`)):"...";return e.jsxs("section",{className:`FlashList Content ${x[d]}`,children:[e.jsx("h3",{className:"title",children:"מבזקים"}),e.jsxs("div",{className:"content",children:[h(),m()]})]})}export{D as default};
