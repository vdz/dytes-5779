import{j as c}from"./jsx-runtime.TBa3i5EZ.js";import{r as i}from"./index.CVf8TyFT.js";import{D as a}from"./ui-display-modes.B23pBYFS.js";import{a as b}from"./contentful-management.kd8tc3DM.js";const l=["normal","processing","error","done","active"],d={name:"",content:"",subject:"",body:"",contact:"",sysMessage:""};function v({page:m}){const[t,s]=i.useState(d),[r,n]=i.useState(a.normal),u=()=>(n(a.active),!1),g=()=>{s(d)},p=async()=>{if(!t.name){n(a.error),s(e=>({...e,sysMessage:"מה שמך?"}));return}if(!t.contact){n(a.error),s(e=>({...e,sysMessage:"מה כתובת דואר האלקטרוני שלך?"}));return}if(!t.subject){n(a.error),s(e=>({...e,sysMessage:"מה נושא פנייתך?"}));return}n(a.processing),s(e=>({...e,sysMessage:"מקבלים משוב..."}));try{await b("feedback",{page_index:m,sender:t.name,sender_contact:t.contact,received_on:new Date().toISOString(),title:t.subject,body:t.body}),g(),n(a.done),s(e=>({...e,sysMessage:"תודה. שמרתנו ..."})),setTimeout(()=>{n(a.normal),s(e=>({...e,sysMessage:""}))},2e3)}catch{n(a.error),s(o=>({...o,sysMessage:"שגיאה בשליחה"}))}},y=e=>{const o=e?e.split(`
`):[""];s(x=>({...x,content:e,subject:o[0],body:o[1]?`
`+o.slice(1).join(`
`):""}))};return c.jsxs("section",{className:`Feedback Content ${l[r]}`,children:[c.jsx("h3",{className:"title",children:"שאל אותנו שאלה"}),c.jsx("p",{children:"יש לכם שאלה? בקשה? משוב? נשמח לשמוע מכם ולסייע לכם ללמוד."}),c.jsx("input",{type:"text",className:"name",onFocus:u,placeholder:"מה שמך?",value:t.name,onChange:e=>s(o=>({...o,name:e.target.value}))}),c.jsx("input",{type:"text",className:"contact",placeholder:"דואל או טלפון ליצירת קשר",value:t.contact,onChange:e=>s(o=>({...o,contact:e.target.value}))}),c.jsx("textarea",{className:"body",placeholder:"הנושא שאני רוצה לדבר עליו...",value:t.content,onChange:e=>y(e.target.value)}),c.jsx("button",{type:"button",className:"submit outline",onClick:p,children:"שלח לנו משוב"}),c.jsx("div",{className:`mode ${l[r]}`,onClick:()=>n(a.active),children:t.sysMessage})]})}export{v as default};
